<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title>ZvF Stafette</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js" integrity="sha512-7oYXeK0OxTFxndh0erL8FsjGvrl2VMDor6fVqzlLGfwOQQqTbYsGPv4ZZ15QHfSk80doyaM0ZJdvkyDcVO7KFA==" crossorigin="anonymous"></script>
    


    <script src="https://kit.fontawesome.com/b6b808bbca.js" crossorigin="anonymous"></script>
    
    <script src="./hlp/csvtojson.min.js"></script>
    <script src="./hlp/luxon.min.js"></script>
    <script src="./hlp/underscore-umd-min.js"></script>
    <script src="./app.js"></script>        
  </head>

  <body ng-app="ZvF" ng-controller="ZvFController as zvFList">
    <div class="container-fluid">
        <div class="row">
          <div class="page-header col-md-10">
            <i class="fas fa-route" style="color:#FF0000; font-size: 4em;""></i><b>&nbsp;</b>
            <i class="fas fa-fast-forward" style="color:#767171; font-size: 4em;"></i><b>&nbsp;</b>
            <b style="color:#767171; font-size: 4em;">&nbsp;ZvF</b>
            <b style="color:#FF0000; font-size: 4em;"">Stafette</b>            
            <h3>ABFK - Bearbeitungsreihenfolge bei Baubetroffenheit</h3>
          </div>
          
          
          <div class="page-header col-md-2">
            <img src="./img/Db-netze.png" class="img-fluid" alt="DB Netz AG Logo">         
          </div>

          <div class="col-md-9 ng-hide animate-show-hide" ng-hide="zvFList.loadComplete">
            <div class="form-group">              
              <div class="col-md-8">                
                <input type="file" id="list" class="form-control form-control-lg" ng-model="zvFList.Filename" accept=".csv" placeholder="Liste auswählen"> <p></p>
                <p><b>Achtung</b> Es werden keinerlei Daten ins Netz hochgeladen. Der Verarbeitung der Daten und Erzeugung der Tabellen erfolgt ausschließlich auf dem lokalen Rechner.</p>
  
                <button type="button" class="btn btn-secondary btn-lg" ng-click="zvFList.assignTrains();">
                    <i class="far fa-file-alt"></i>                    
                    Daten einlesen und verarbeiten
                </button>
              </div>         
            </div>
          </div>

          <div class="animate-show-hide ng-show" ng-show="zvFList.loadComplete">
            <nav>
              <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <button class="nav-link active text-danger" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Übersicht MFB</button>
                <button class="nav-link text-danger" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Wochensicht Gruppe</button>
                <button class="nav-link text-danger" id="nav-mfb-tab" data-bs-toggle="tab" data-bs-target="#nav-mfb" type="button" role="tab" aria-controls="nav-mfb" aria-selected="false">Wochensicht Zugnummer</button>
                <button class="nav-link text-danger" id="nav-red-tab" data-bs-toggle="tab" data-bs-target="#nav-red" type="button" role="tab" aria-controls="nav-red" aria-selected="false">Abarbeitung Stafette</button>
                <button class="nav-link text-light" id="nav-saved-tab" data-bs-toggle="tab" data-bs-target="#nav-saved" type="button" role="tab" aria-controls="nav-saved" aria-selected="false">...</button>
                <button class="nav-link text-light" id="nav-edit-tab" data-bs-toggle="tab" data-bs-target="#nav-edit" type="button" role="tab" aria-controls="nav-edit" aria-selected="false">...</button>
              </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">              
              <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                <div class="col-md-8">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th>Betroffenheit durch Bau</th>
                        <th>Summe Verkehrstage der betroffenen Züge</th>
                        <th>&nbsp;</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-repeat="tr in zvFList.Groups | orderBy:['-id']">
                        <td>{{tr.name}}</td>
                        <td>{{tr.trains.length}}</td>
                        <td>
                          <button type="button btn-sm" ng-click="zvFList.showGroup(tr.id);" class="btn btn-outline-secondary">
                            <i class="far fa-hand-pointer"></i>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                <div class="col-md-8">
                  <h4>Wochensicht {{zvFList.selGroup}}</h4>
                    <table class="table table-hover">
                      <thead>
                        <tr>
                          <th>Rz/Gz</th>
                          <th>Zugnummer</th>
                          <th>Verkehrstage</th>
                          <th>&nbsp;</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr ng-repeat="tr in zvFList.DetailGroup | orderBy:['-type', 'znr']">
                          <td>
                            <span class="animate-show-hide ng-show" ng-show="tr.type==='G'"><i class="fas fa-trailer"></i></span>
                            <span class="animate-show-hide ng-show" ng-show="tr.type==='R'"><i class="fas fa-hot-tub"></i></span>
                          </td>
                          <td>{{tr.znr}}</td>
                          <td>{{tr.dayList}}</td>
                          <td>
                            <button type="button btn-sm" ng-click="zvFList.showTrain(tr.znr, tr.days);" class="btn btn-outline-secondary">
                              <i class="fas fa-pencil-alt"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>                                    
                </div>
              </div>

              <div class="tab-pane fade" id="nav-mfb" role="tabpanel" aria-labelledby="nav-mfb-tab">
                <div class="col-md-10">
                  <h4>
                    Zugnummer {{zvFList.selTrain}}
                    <span class="animate-show-hide ng-show" ng-show="zvFList.TrainDetail[0].type==='G'"><i class="fas fa-trailer"></i></span>
                    <span class="animate-show-hide ng-show" ng-show="zvFList.TrainDetail[0].type==='R'"><i class="fas fa-hot-tub"></i></span>
                  </h4>
                  
                    <table class="table">                      
                        <tr>
                          <td ng-repeat="d in zvFList.TrainDetail">
                            <table class="table table-sm table-borderless">
                              <tr>
                                <td><button type="button" ng-click="zvFList.setOrder(d, true);" class="btn btn-secondary btn-lg"><i class="far fa-arrow-alt-circle-down"></i></button></td>
                                <td><button type="button" ng-click="zvFList.setOrder(d, false);" class="btn btn-secondary btn-lg"><i class="far fa-arrow-alt-circle-up"></i></button></td>
                                <td>{{d.dir}}</td>
                              </tr>
                            </table>
                            <table class="table table-sm">
                              <tr class="table-dark">
                                <th>Verkehrstag</th>
                                <th>{{d.day.DText}}</th>
                              </tr>
                              <tr ng-repeat="tr in d.trains | orderBy:['Konflikt.DNumber']">
                                <td ng-style="{'background-color': tr.Color, 'color': 'white'}"><i class="fas fa-globe-africa"></i> <b>{{tr.Region}}</b><br><i class="fas fa-road"></i> {{tr.Streckennummer}}<br>{{tr.Vorgangsnummer}}<br><i class="fas fa-calendar-day"></i> {{tr.Konflikt.Day}}</td>
                                <td ng-style="{'background-color': tr.Color, 'color': 'white'}">&nbsp;<br><i class="fas fa-map-marker-alt"></i> {{tr.Betriebsstelle}}<br><i class="fas fa-snowplow"></i> {{tr['Art der bVE']}}<br><i class="far fa-clock"></i> {{tr.Konflikt.Time}}</td>
                              </tr>
                            </table>
                          </td>                          
                        </tr>
                    </table>                                    
                </div>
              </div>

              <div class="tab-pane fade" id="nav-red" role="tabpanel" aria-labelledby="nav-red-tab">
                <div class="col-md-10">
                  <h4>Auswahl Region</h4>
                  <table class="table table-sm table-borderless">                    
                    <tr>
                      <td>
                        <button type="button" class="animate-show-hide ng-show btn btn-secondary btn-lg" ng-show="zvFList.selRegion === 'NORD'">Nord</button>
                        <button type="button" class="animate-show-hide ng-show btn btn-outline-secondary btn-lg" ng-click="zvFList.setRegion('NORD');" ng-hide="zvFList.selRegion === 'NORD'">Nord</button>
                      </td>
                      <td>
                        <button type="button" class="animate-show-hide ng-show btn btn-secondary btn-lg" ng-show="zvFList.selRegion === 'OST'">Ost</button>
                        <button type="button" class="animate-show-hide ng-show btn btn-outline-secondary btn-lg" ng-click="zvFList.setRegion('OST');" ng-hide="zvFList.selRegion === 'OST'">Ost</button>
                      </td>
                      <td>
                        <button type="button" class="animate-show-hide ng-show btn btn-secondary btn-lg" ng-show="zvFList.selRegion === 'SÜDOST'">Südost</button>
                        <button type="button" class="animate-show-hide ng-show btn btn-outline-secondary btn-lg" ng-click="zvFList.setRegion('SÜDOST');" ng-hide="zvFList.selRegion === 'SÜDOST'">Südost</button>
                      </td>
                      <td>
                        <button type="button" class="animate-show-hide ng-show btn btn-secondary btn-lg" ng-show="zvFList.selRegion === 'MITTE'">Mitte</button>
                        <button type="button" class="animate-show-hide ng-show btn btn-outline-secondary btn-lg" ng-click="zvFList.setRegion('MITTE');" ng-hide="zvFList.selRegion === 'MITTE'">Mitte</button>
                      </td>
                      <td>
                        <button type="button" class="animate-show-hide ng-show btn btn-secondary btn-lg" ng-show="zvFList.selRegion === 'WEST'">West</button>
                        <button type="button" class="animate-show-hide ng-show btn btn-outline-secondary btn-lg" ng-click="zvFList.setRegion('WEST');" ng-hide="zvFList.selRegion === 'WEST'">West</button>
                      </td>
                      <td>
                        <button type="button" class="animate-show-hide ng-show btn btn-secondary btn-lg" ng-show="zvFList.selRegion === 'SÜDWEST'">Südwest</button>
                        <button type="button" class="animate-show-hide ng-show btn btn-outline-secondary btn-lg" ng-click="zvFList.setRegion('SÜDWEST');" ng-hide="zvFList.selRegion === 'SÜDWEST'">Südwest</button>
                      </td>
                      <td>
                        <button type="button" class="animate-show-hide ng-show btn btn-secondary btn-lg" ng-show="zvFList.selRegion === 'SÜD'">Süd</button>
                        <button type="button" class="animate-show-hide ng-show btn btn-outline-secondary btn-lg" ng-click="zvFList.setRegion('SÜD');" ng-hide="zvFList.selRegion === 'SÜD'">Süd</button>
                      </td>
                    </tr>
                  </table>

                  <h4>Baubetroffenheit je Korridor</h4>
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th>Korridor</th>
                        <th>Prioritäre Züge</th>
                        <th>Gesamtzahl Züge <i class="fas fa-dot-circle"></i> Verkehrstage</th>
                        <th>&nbsp;</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-repeat="tr in zvFList.regBTK | orderBy:['-PRIO', '-ANZ']">
                        <td>{{tr.BTK}}</td>
                        <td>{{tr.PRIO}}</td>
                        <td>{{tr.ANZ}}</td>
                        <td>
                          <button type="button btn-sm" ng-click="zvFList.showCorridor(tr.id);" class="btn btn-outline-secondary">
                            <i class="far fa-hand-pointer"></i>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="tab-pane fade" id="nav-saved" role="tabpanel" aria-labelledby="nav-saved-tab">
                <div class="col-md-11">
                  <h4>Region {{zvFList.selRegion}}, Korridor {{zvFList.selBTK[0].BTK}}</h4>
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th>Tag</th>
                        <th>Rz/Gz</th>
                        <th>Zugnummer</th>                        
                        <th>Wichtigkeit</th>
                        <th>Bearbeitung</th>
                        <th>&nbsp;</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-repeat="tr in zvFList.selBTK | orderBy:['K_DAY.DNumber']">
                        <td>{{tr.K_DAY.Day}}</td>
                        <td>
                          <span class="animate-show-hide ng-show" ng-show="tr.TYPE==='G'"><i class="fas fa-trailer"></i></span>
                          <span class="animate-show-hide ng-show" ng-show="tr.TYPE==='R'"><i class="fas fa-hot-tub"></i></span>
                        </td>
                        <td>{{tr.ZNR}}</td>
                        <td>{{tr.WEIGHT}}</td>
                        <td>{{tr.DIR}}</td>
                        <td>
                          .
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>


            </div> 
          </div>

          
                    

        </div>

        <div class="col-md-12">
            <p></p>
            <p><i class="fas fa-code"></i> <b>DB Netz AG</b> | Fahrplan und Kapazitätsmanagement | Region Mitte | I.NB-MI-F | 2021</p>
          </div>

    </div>

  </body>

  </html>